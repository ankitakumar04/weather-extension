!function(){var t=function(t,e,n){var a=document.createElement(t);for(var s in e)a.setAttribute(s,e[s]);return a.innerHTML=n||null,a},e=function(t,e,n,a){var s=new XMLHttpRequest;s.open(e,t,!0),s.onload=function(){this.status>=200&&this.status<400?n(this):a(this)},s.onerror=function(){a(this)},s.send()},n=function(e){this.attrs=e,this.render=function(){var e=t("div",{"class":"current"}),n=t("img",{"class":"current-img",src:this.attrs.img,alt:"icon"}),a=t("div",{"class":"weather"});return a.appendChild(t("span",{},this.attrs.temp+"&deg")),a.appendChild(t("span",{},this.attrs.desc)),e.appendChild(n),e.appendChild(a),e}},a=function(e){this.attrs=e,this.render=function(){var e=t("div",{"class":"period"});return e.appendChild(t("span",{"class":"time"},this.attrs.time)),e.appendChild(t("img",{src:this.attrs.img,alt:"icon"})),e.appendChild(t("span",{"class":"temp"},this.attrs.temp+"&deg")),e.appendChild(t("span",{"class":"precip"},this.attrs.precip+"mm")),e}},s=function(e){this.attrs=e,this.render=function(){for(var e=t("div",{"class":"today"}),n=new a,s=this.attrs.today.length,r=0;s>r;r++)n.attrs=this.attrs.today[r],e.appendChild(n.render());return e}},r=function(e){this.attrs=e,this.render=function(){var e=t("div",{"class":"weather"},'<span class="temp">'+this.attrs.temp+'&deg</span><span class="description">'+this.attrs.desc+"</span>"),n=t("div",{"class":"date"},'<p class="weekday">'+this.attrs.weekday+'</p><p class="month">'+this.attrs.month+"</p>"),a=t("div",{"class":"day"});return a.appendChild(t("img",{src:this.attrs.img,alt:"icon"})),a.appendChild(e),a.appendChild(n),a}},i=function(e){this.attrs=e,this.render=function(){for(var e=t("div",{"class":"forecast"}),n=new r,a=this.attrs.days.length,s=0;a>s;s++)n.attrs=this.attrs.days[s],e.appendChild(n.render());return e}},o=function(e,a,r){var o=new n(e),d=new s({today:a}),p=new i({days:r});document.body.appendChild(o.render()),document.body.appendChild(t("hr")),document.body.appendChild(d.render()),document.body.appendChild(t("hr")),document.body.appendChild(p.render())},d=function(t){console.log(t);var e,n,a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["January","February","March","April","May","June","July","August","September","October","November","December"],r={img:"icons/"+t[0].weather[0].icon.substr(0,2)+".png",temp:Math.round(t[0].main.temp-273.15),desc:t[0].weather[0].main},i=[];for(e=0;5>e;e++){n=new Date(1e3*t[1].list[e].dt);var d="0"+n.getHours();d=d.substr(d.length-2);var p="0"+n.getMinutes();p=p.substr(p.length-2);var c=0;t[1].list[e].rain?c=t[1].list[e].rain["3h"]:t[1].list[e].snow&&(c=t[1].list[e].snow["3h"]),i.push({img:"icons/"+t[1].list[e].weather[0].icon.substr(0,2)+".png",temp:Math.round(t[1].list[e].main.temp-273.15),precip:c,time:d+":"+p})}var h=[];for(e=0;5>e;e++)n=new Date(1e3*t[2].list[e].dt),h.push({img:"icons/"+t[2].list[e].weather[0].icon.substr(0,2)+".png",temp:Math.round(t[2].list[e].temp.max-273.15),desc:t[2].list[e].weather[0].main,weekday:a[n.getDay()],month:s[n.getMonth()]+" "+n.getDate()});o(r,i,h)},p=function(){var t=0,e=[];return function(n,a){t++,e[a]=JSON.parse(n.response),t>=3&&(d(e),t=0,e=[])}}();e("http://api.openweathermap.org/data/2.5/weather?q=waterloo,ca","GET",function(t){console.log("make"),p(t,0)},function(){console.log("error")}),e("http://api.openweathermap.org/data/2.5/forecast?q=waterloo,ca","GET",function(t){p(t,1)},function(){console.log("error")}),e("http://api.openweathermap.org/data/2.5/forecast/daily?q=waterloo,ca","GET",function(t){p(t,2)},function(){console.log("error")})}();